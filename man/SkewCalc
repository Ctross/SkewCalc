\name{SkewCalc}
\alias{SkewCalc}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{Calculate Posterior Confidence Intervals for Estimates of M and Mc with Bayesian Negative Binomial Models}
\description{
SkewCals allows users to calculate the posterior confidence intervals for estimates of M and Mc with various exposure time truncated Bayesian negative binomial models.
}
\usage{
SkewCalc( RS, Exposure , MaxExposure=max(Exposure), Samples=1000 , MethodFit="ETNBShiftingShape" , MethodCI="HPDI", P=0.95, Prior="Default",Updates="TRUE", PlotResults="TRUE")
}
%- maybe also 'usage' for other objects documented here.
\arguments{
\item{RS}{A vector of reproductive success (or any count for which skew is to be calculated) values. Must be integer-valued.}
\item{Exposure}{A vector of exposure times to risk of RS. Must be integer-valued.}
\item{MaxExposure}{Upper limit of exposure time. This value allows the model to account for an inflated number of individuals at completed reproduction.}
\item{Samples}{Number of samples from the posterior distribution. Defaults to 1000. }
\item{MethodFit}{Defines the Bayesian model to be used in estimating the population-level joint distribtution of RS and Exposure time. Options are: "ETNBShiftingShape" (Default), "ETNBShiftingShapeScale", "ETZINBShiftingShape", "ETZINBShiftingShapeScale", "ETHNBShiftingShape","ETHNBShiftingShapeScale". See Details.}
\item{MethodCI}{Method for calculating confidences intervals. Options are: "HPDI" (Default) or "PCI". See Details.}
\item{P}{Percentile of confidence interval. Defaults to 0.95.}
\item{Priors}{Priors for the Bayesian model. Defaults depend on the model. See Details.}
\item{Updates}{If "TRUE" prints progress reports.}
\item{PlotResults}{If "TRUE" plots posterior distributions. See Details.}
}
\details{
This command provides a convenient interface for estimating the population-level joint distribtution of RS and Exposure time, using one of a suite of theoretically derived Bayesian models. Posterior estimates of M and Mc are derived from the population-level joint distribtution.
The symbols for \code{MethodFit} stand for "E(xposure) T(runcated) N(egative) B(inomial)", with options for "Z(ero) I(nflated)" and "H(urdle)". "ShiftingShape" implies that the Shape parameter of the Gamma distribution underlying Gamma-Poisson (aka. Negative Binomial) shifts as a function of Exposure time. "ShiftingShapeScale" implies that both the Shape and Scale parameter of the Gamma distribution shifts as a function of Exposure time. 
The symbols for \code{MethodCI} stand for H(ighest) P(osteior) D(ensity) I(nterval) or Central P(osteior) C(redibility) I(nterval).
Custom priors (Gaussian on unconstrained space) can be specified with a list; however, this is not recommended for most users.
If \code{PlotResults}="TRUE", plots of the sample and population-level joint distribution, and density plots of the sample and population-level RS and Exposure variables, will be returned with the estimates of M and Mc. These plots should appear similar. Divergence between the sample and poulation estimates might be indicative that a better model is needed.
}
\value{
Returns an object of class \code{map} with the following slots.
\item{call}{The function call}
\item{coef}{The estimated posterior modes}
\item{vcov}{Variance-covariance matrix}
\item{optim}{List returned by \code{optim}}
\item{data}{The data}
\item{formula}{Formula list}
\item{fminuslogl}{Minus log-likelihood function that accepts a vector of parameter values}
}
\references{McElreath 2011, Statistical Rethinking.}
\author{Richard McElreath}
\seealso{\code{\link{optim}}}
\examples{
data(cars)
flist <- alist(
dist ~ dnorm( mean=mu , sd=sigma ) ,
mu <- a+b*speed ,
c(a,b) ~ dnorm(0,10) ,
sigma ~ dcauchy(0,1)
)
fit <- map( flist , start=list(a=40,b=0.1,sigma=20) , data=cars )
# regularized logistic regression example
y <- c( rep(0,10) , rep(1,10) )
x <- c( rep(-1,9) , rep(1,11) )
flist0 <- alist(
y ~ dbinom( prob=p , size=1 ) ,
logit(p) <- a + b*x
)
flist1 <- alist(
y ~ dbinom( prob=p , size=1 ),
logit(p) <- a + b*x ,
c(a,b) ~ dnorm(0,10)
)
# without priors, same problem as:
# glm3a <- glm( y ~ x , family=binomial , data=list(y=y,x=x) )
fit3a <- map( flist0 , data=list(y=y,x=x) , start=list(a=0,b=0) )
precis(fit3a)
# now with regularization
fit3b <- map( flist1 , data=list(y=y,x=x) , start=list(a=0,b=0) )
precis(fit3b)
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
\keyword{ }
